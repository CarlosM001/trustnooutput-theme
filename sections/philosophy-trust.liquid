{% comment %}
  TRUST.NO.OUTPUT — Philosophy Section

  This section presents the theoretical foundation of the brand through
  the lens of three critical thinkers: Byung-Chul Han, Franco Berardi,
  and Shoshana Zuboff. It serves as an intellectual bridge between
  commercial design and critical theory.

  Features:
  - Scroll-reveal animations (Intersection Observer)
  - Thinker cards with glitch hover effects
  - Terminal-style quotes
  - Responsive grid layout
  - Accessibility support (prefers-reduced-motion)
{% endcomment %}

<style>
  /* Variables are globally provided by assets/trust-variables.css */

  /* ========================================
     Philosophy Section Base
     ======================================== */

  .philosophy-trust {
    position: relative;
    padding: var(--space-xl) var(--space-md);
    background: var(--color-deep-black);
    overflow: hidden;
  }

  .philosophy-trust__container {
    max-width: 1200px;
    margin: 0 auto;
  }

  /* Subtle Background Grid Pattern */
  .philosophy-trust::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: linear-gradient(rgba(0, 255, 240, 0.02) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0, 255, 240, 0.02) 1px, transparent 1px);
    background-size: 50px 50px;
    opacity: 0.3;
    pointer-events: none;
  }

  /* ========================================
     Section Header
     ======================================== */

  .philosophy-trust__header {
    text-align: center;
    margin-bottom: var(--space-lg);
    opacity: 0;
    transform: translateY(30px);
    transition: opacity var(--anim-slow) ease, transform var(--anim-slow) ease;
  }

  .philosophy-trust__header.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .philosophy-trust__eyebrow {
    font-family: var(--font-mono);
    font-size: clamp(0.75rem, 2vw, 0.875rem);
    font-weight: 400;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--color-cyan);
    margin: 0 0 var(--space-sm);
  }

  .philosophy-trust__headline {
    font-family: var(--font-mono);
    font-size: clamp(1.75rem, 5vw, 3rem);
    font-weight: 700;
    letter-spacing: 0.02em;
    color: #ffffff;
    margin: 0 0 var(--space-md);
    position: relative;
  }

  /* Subtle underline glitch */
  .philosophy-trust__headline::after {
    content: '';
    display: block;
    width: 100px;
    height: 2px;
    background: linear-gradient(90deg, var(--color-cyan), var(--color-magenta));
    margin: var(--space-sm) auto 0;
    animation: underline-glitch var(--anim-glacial) ease-in-out infinite;
  }

  @keyframes underline-glitch {
    0%,
    100% {
      width: 100px;
      opacity: 1;
    }
    50% {
      width: 80px;
      opacity: 0.7;
    }
  }

  .philosophy-trust__intro {
    font-family: var(--font-clean);
    font-size: clamp(1rem, 2.5vw, 1.25rem);
    font-weight: 300;
    line-height: 1.7;
    color: var(--color-gray-ghost);
    max-width: 700px;
    margin: 0 auto;
  }

  /* ========================================
     Thinker Cards Grid
     ======================================== */

  .philosophy-trust__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--space-md);
    margin-top: var(--space-lg);
  }

  /* Individual Thinker Card */
  .thinker-card {
    position: relative;
    background: var(--color-void-black);
    border: 1px solid var(--color-gray-dim);
    padding: var(--space-md);
    transition: all var(--anim-fast) ease;
    opacity: 0;
    transform: translateY(50px);
  }

  .thinker-card.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Stagger animation delay */
  .thinker-card:nth-child(1).is-visible {
    transition-delay: 0.1s;
  }

  .thinker-card:nth-child(2).is-visible {
    transition-delay: 0.2s;
  }

  .thinker-card:nth-child(3).is-visible {
    transition-delay: 0.3s;
  }

  /* Hover State with Subtle Glitch */
  .thinker-card:hover {
    border-color: var(--color-cyan);
    box-shadow: 0 0 20px rgba(0, 255, 240, 0.1);
    transform: translateY(-4px);
  }

  /* Glitch effect on hover */
  .thinker-card::before,
  .thinker-card::after {
    content: '';
    position: absolute;
    inset: 0;
    border: 1px solid;
    opacity: 0;
    transition: opacity var(--anim-instant) ease;
    pointer-events: none;
  }

  .thinker-card::before {
    border-color: var(--color-cyan);
    transform: translate(-2px, -2px);
  }

  .thinker-card::after {
    border-color: var(--color-magenta);
    transform: translate(2px, 2px);
  }

  .thinker-card:hover::before,
  .thinker-card:hover::after {
    opacity: 0.3;
  }

  /* Card Content */
  .thinker-card__name {
    font-family: var(--font-mono);
    font-size: clamp(1.25rem, 3vw, 1.5rem);
    font-weight: 700;
    letter-spacing: 0.02em;
    color: var(--color-cyan);
    margin: 0 0 var(--space-xs);
    position: relative;
  }

  /* Terminal cursor effect on name */
  .thinker-card__name::after {
    content: '▮';
    margin-left: 0.25em;
    opacity: 0;
    animation: cursor-blink 1s step-end infinite;
    color: var(--color-terminal-green);
  }

  .thinker-card:hover .thinker-card__name::after {
    opacity: 1;
  }

  @keyframes cursor-blink {
    0%,
    50% {
      opacity: 1;
    }
    51%,
    100% {
      opacity: 0;
    }
  }

  .thinker-card__title {
    font-family: var(--font-clean);
    font-size: clamp(0.875rem, 2vw, 1rem);
    font-weight: 400;
    font-style: italic;
    color: var(--color-gray-ghost);
    margin: 0 0 var(--space-sm);
  }

  .thinker-card__quote {
    font-family: var(--font-mono);
    font-size: clamp(0.875rem, 2vw, 0.95rem);
    font-weight: 400;
    line-height: 1.6;
    color: var(--color-gray-ghost);
    margin: 0 0 var(--space-sm);
    padding-left: var(--space-sm);
    border-left: 2px solid var(--color-gray-dim);
    position: relative;
  }

  /* Quote marks */
  .thinker-card__quote::before {
    content: '>';
    position: absolute;
    left: 0;
    color: var(--color-terminal-green);
    animation: terminal-flicker var(--anim-slow) ease-in-out infinite;
  }

  @keyframes terminal-flicker {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.85;
    }
    55% {
      opacity: 1;
    }
    60% {
      opacity: 0.9;
    }
  }

  .thinker-card__concept {
    font-family: var(--font-mono);
    font-size: clamp(0.75rem, 1.5vw, 0.875rem);
    font-weight: 500;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: var(--color-magenta);
    margin: var(--space-sm) 0 0;
  }

  /* ========================================
     Call-to-Action (Read More)
     ======================================== */

  .philosophy-trust__cta {
    text-align: center;
    margin-top: var(--space-xl);
    opacity: 0;
    transform: translateY(30px);
    transition: opacity var(--anim-slow) ease, transform var(--anim-slow) ease;
    transition-delay: 0.6s;
  }

  .philosophy-trust__cta.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .philosophy-trust__cta-button {
    font-family: var(--font-mono);
    font-size: clamp(0.875rem, 2vw, 1rem);
    font-weight: 500;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    text-decoration: none;
    padding: 1rem 2rem;
    border: 2px solid var(--color-magenta);
    color: var(--color-magenta);
    background: transparent;
    display: inline-block;
    transition: all var(--anim-fast) ease;
    position: relative;
    overflow: hidden;
  }

  .philosophy-trust__cta-button::before {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--color-magenta);
    opacity: 0;
    transition: opacity var(--anim-fast) ease;
  }

  .philosophy-trust__cta-button:hover::before {
    opacity: 0.1;
  }

  .philosophy-trust__cta-button:hover {
    box-shadow: 0 0 15px rgba(255, 0, 255, 0.3);
    animation: terminal-flicker var(--anim-fast) ease-in-out;
  }

  .philosophy-trust__cta-button span {
    position: relative;
    z-index: 1;
  }

  /* ========================================
     Responsive Design
     ======================================== */

  @media (max-width: 768px) {
    .philosophy-trust {
      padding: var(--space-lg) var(--space-sm);
    }

    .philosophy-trust__grid {
      grid-template-columns: 1fr;
      gap: var(--space-sm);
    }

    .thinker-card {
      padding: var(--space-sm);
    }

    /* Simplify hover effects on mobile */
    .thinker-card::before,
    .thinker-card::after {
      display: none;
    }
  }

  /* ========================================
     Accessibility: Reduced Motion
     ======================================== */

  @media (prefers-reduced-motion: reduce) {
    .philosophy-trust__header,
    .thinker-card,
    .philosophy-trust__cta {
      opacity: 1;
      transform: none;
      transition: none;
    }

    .thinker-card:hover {
      transform: none;
    }

    .philosophy-trust__headline::after,
    .thinker-card__name::after,
    .thinker-card__quote::before {
      animation: none;
    }
  }
</style>

{%- liquid
  assign eyebrow = section.settings.eyebrow | default: 'Theoretical Foundation'
  assign headline = section.settings.headline | default: 'Philosophy'
  assign intro = section.settings.intro | default: 'TRUST.NO.OUTPUT is grounded in critical theory — examining the invisible structures that shape digital consciousness.'

  assign cta_text = section.settings.cta_text | default: 'Read Full Manifesto'
  assign cta_url = section.settings.cta_url
-%}
<section class="philosophy-trust" id="philosophy-section">
  <div class="philosophy-trust__container">
    {%- comment %} Section Header {%- endcomment %}
    <div class="philosophy-trust__header" data-scroll-reveal>
      {%- if eyebrow != blank -%}
        <p class="philosophy-trust__eyebrow">{{ eyebrow }}</p>
      {%- endif -%}

      {%- if headline != blank -%}
        <h2 class="philosophy-trust__headline">{{ headline }}</h2>
      {%- endif -%}

      {%- if intro != blank -%}
        <p class="philosophy-trust__intro">{{ intro }}</p>
      {%- endif -%}
    </div>

    {%- comment %} Thinker Cards Grid {%- endcomment %}
    <div class="philosophy-trust__grid">
      {%- for block in section.blocks -%}
        {%- if block.type == 'thinker' -%}
          <article class="thinker-card" data-scroll-reveal {{ block.shopify_attributes }}>
            <h3 class="thinker-card__name">{{ block.settings.name }}</h3>

            {%- if block.settings.title != blank -%}
              <p class="thinker-card__title">{{ block.settings.title }}</p>
            {%- endif -%}

            {%- if block.settings.quote != blank -%}
              <blockquote class="thinker-card__quote">{{ block.settings.quote }}</blockquote>
            {%- endif -%}

            {%- if block.settings.concept != blank -%}
              <p class="thinker-card__concept">{{ block.settings.concept }}</p>
            {%- endif -%}
          </article>
        {%- endif -%}
      {%- endfor -%}
    </div>

    {%- comment %} Call to Action {%- endcomment %}
    {%- if cta_text != blank -%}
      <div class="philosophy-trust__cta" data-scroll-reveal>
        <a href="{{ cta_url }}" class="philosophy-trust__cta-button">
          <span>{{ cta_text }}</span>
        </a>
      </div>
    {%- endif -%}
  </div>
</section>

<script>
  /**
   * TRUST.NO.OUTPUT — Philosophy Section Interactions
   *
   * Scroll-Reveal Animation using Intersection Observer API
   * Progressive enhancement: Works without JS, enhanced with JS
   */

  (function () {
    'use strict';

    // Check for reduced motion preference
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    if (prefersReducedMotion) {
      // Add .is-visible class immediately for reduced motion users
      const elements = document.querySelectorAll('[data-scroll-reveal]');
      elements.forEach((el) => el.classList.add('is-visible'));
      return;
    }

    // Check if Intersection Observer is supported
    if (!('IntersectionObserver' in window)) {
      // Fallback: Make all elements visible immediately
      const elements = document.querySelectorAll('[data-scroll-reveal]');
      elements.forEach((el) => el.classList.add('is-visible'));
      return;
    }

    /**
     * Intersection Observer Configuration
     * Triggers when element is 20% visible in viewport
     */
    const observerOptions = {
      root: null,
      rootMargin: '0px',
      threshold: 0.2,
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          observer.unobserve(entry.target); // Stop observing after reveal
        }
      });
    }, observerOptions);

    // Observe all elements with data-scroll-reveal attribute
    const revealElements = document.querySelectorAll('[data-scroll-reveal]');

    revealElements.forEach((element) => {
      observer.observe(element);
    });

    /**
     * CTA Button — Conscious Delay (optional enhancement)
     */
    const ctaButton = document.querySelector('.philosophy-trust__cta-button');

    if (ctaButton) {
      ctaButton.addEventListener('click', function (e) {
        // Skip delay for modifier keys (open in new tab)
        if (e.metaKey || e.ctrlKey || e.button === 1) {
          return;
        }

        e.preventDefault();
        const targetUrl = this.getAttribute('href');

        // Visual feedback
        this.style.opacity = '0.5';

        // Conscious 400ms delay
        setTimeout(() => {
          window.location.href = targetUrl;
        }, 400);
      });
    }
  })();
</script>

{% schema %}
{
  "name": "Philosophy (TNO)",
  "class": "section-philosophy-trust",
  "settings": [
    {
      "type": "header",
      "content": "Section Header"
    },
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow Text",
      "default": "Theoretical Foundation",
      "info": "Small text above headline"
    },
    {
      "type": "text",
      "id": "headline",
      "label": "Section Headline",
      "default": "Philosophy"
    },
    {
      "type": "textarea",
      "id": "intro",
      "label": "Introduction Text",
      "default": "TRUST.NO.OUTPUT is grounded in critical theory — examining the invisible structures that shape digital consciousness."
    },
    {
      "type": "header",
      "content": "Call to Action"
    },
    {
      "type": "text",
      "id": "cta_text",
      "label": "Button Text",
      "default": "Read Full Manifesto"
    },
    {
      "type": "url",
      "id": "cta_url",
      "label": "Button URL"
    },
    {
      "type": "header",
      "content": "Advanced Settings"
    },
    {
      "type": "checkbox",
      "id": "enable_scroll_reveal",
      "label": "Enable Scroll Reveal Animations",
      "default": true,
      "info": "Respects prefers-reduced-motion setting"
    }
  ],
  "blocks": [
    {
      "type": "thinker",
      "name": "Thinker Card",
      "settings": [
        {
          "type": "text",
          "id": "name",
          "label": "Thinker Name",
          "default": "Byung-Chul Han"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title / Work",
          "default": "Philosopher, Author of 'Psychopolitik'"
        },
        {
          "type": "textarea",
          "id": "quote",
          "label": "Key Quote",
          "default": "We are in a crisis of freedom. Freedom is being exploited for purposes of control."
        },
        {
          "type": "text",
          "id": "concept",
          "label": "Key Concept",
          "default": "Digital Exhaustion"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Philosophy (TNO)",
      "category": "Trust.No.Output",
      "blocks": [
        {
          "type": "thinker",
          "settings": {
            "name": "Byung-Chul Han",
            "title": "Philosopher, Author of 'Psychopolitik'",
            "quote": "We are in a crisis of freedom. Freedom is being exploited for purposes of control.",
            "concept": "Digital Exhaustion"
          }
        },
        {
          "type": "thinker",
          "settings": {
            "name": "Franco Berardi",
            "title": "Theorist of Semio-Capitalism",
            "quote": "The soul is at work. Cognitive labor has become the primary form of exploitation.",
            "concept": "Semio-Capital"
          }
        },
        {
          "type": "thinker",
          "settings": {
            "name": "Shoshana Zuboff",
            "title": "Author of 'The Age of Surveillance Capitalism'",
            "quote": "We are the sources of surveillance capitalism's surplus. Data about us is harvested for prediction.",
            "concept": "Surveillance Capital"
          }
        }
      ]
    }
  ]
}
{% endschema %}
